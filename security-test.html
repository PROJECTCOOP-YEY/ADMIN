<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîí Security Headers Test - Admin Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 15px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { opacity: 0.9; font-size: 1.1em; }
        .content { padding: 30px; }
        .test-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px;
        }
        .test-card { 
            background: #f8f9fa; 
            border-radius: 10px; 
            padding: 20px; 
            border-left: 4px solid #007bff;
            transition: transform 0.3s ease;
        }
        .test-card:hover { transform: translateY(-5px); }
        .test-card h3 { color: #2c3e50; margin-bottom: 15px; }
        .status { 
            padding: 10px 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .pass { 
            background: linear-gradient(135deg, #d4edda, #c3e6cb); 
            color: #155724; 
            border: 1px solid #c3e6cb; 
        }
        .fail { 
            background: linear-gradient(135deg, #f8d7da, #f5c6cb); 
            color: #721c24; 
            border: 1px solid #f5c6cb; 
        }
        .warning { 
            background: linear-gradient(135deg, #fff3cd, #ffeaa7); 
            color: #856404; 
            border: 1px solid #ffeaa7; 
        }
        .info { 
            background: linear-gradient(135deg, #d1ecf1, #bee5eb); 
            color: #0c5460; 
            border: 1px solid #bee5eb; 
        }
        button { 
            background: linear-gradient(135deg, #007bff, #0056b3); 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 8px; 
            cursor: pointer; 
            margin: 5px; 
            font-weight: 600;
            transition: all 0.3s ease;
        }
        button:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 5px 15px rgba(0,123,255,0.3);
        }
        .results { 
            background: #f8f9fa; 
            border-radius: 10px; 
            padding: 20px; 
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        .csp-policy { 
            background: #2c3e50; 
            color: #ecf0f1; 
            padding: 20px; 
            border-radius: 8px; 
            font-family: 'Courier New', monospace; 
            white-space: pre-wrap; 
            margin: 15px 0;
            overflow-x: auto;
        }
        .score-display {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }
        .score-display h2 { font-size: 2em; margin-bottom: 10px; }
        .progress-bar {
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            background: white;
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí Security Headers Test</h1>
            <p>Comprehensive security validation for your Admin Dashboard</p>
        </div>
        
        <div class="content">
            <div class="score-display">
                <h2 id="security-score">Security Score: 0%</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
                <p id="score-description">Click "Run All Tests" to get your security score</p>
            </div>
            
            <div class="test-grid">
                <div class="test-card">
                    <h3>üõ°Ô∏è Security Headers</h3>
                    <button onclick="checkSecurityHeaders()">Check Headers</button>
                    <div id="headers-results"></div>
                </div>
                
                <div class="test-card">
                    <h3>üîí Content Security Policy</h3>
                    <button onclick="testCSP()">Test CSP</button>
                    <div id="csp-results"></div>
                </div>
                
                <div class="test-card">
                    <h3>üö´ XSS Protection</h3>
                    <button onclick="testXSSProtection()">Test XSS</button>
                    <div id="xss-results"></div>
                </div>
                
                <div class="test-card">
                    <h3>üñºÔ∏è Clickjacking Protection</h3>
                    <button onclick="testClickjacking()">Test Frame Options</button>
                    <div id="frame-results"></div>
                </div>
            </div>
            
            <div style="text-align: center; margin: 30px 0;">
                <button onclick="runAllTests()" style="background: linear-gradient(135deg, #28a745, #20c997); padding: 15px 30px; font-size: 1.1em;">
                    üöÄ Run All Security Tests
                </button>
                <button onclick="generateReport()" style="background: linear-gradient(135deg, #6f42c1, #e83e8c); padding: 15px 30px; font-size: 1.1em;">
                    üìä Generate Security Report
                </button>
            </div>
            
            <div class="results" id="test-results">
                <h3>üìã Test Results</h3>
                <p>Click the buttons above to start testing your security headers.</p>
            </div>
        </div>
    </div>

    <script>
        let testResults = {
            headers: 0,
            csp: 0,
            xss: 0,
            frame: 0,
            total: 0
        };
        
        function addResult(message, type = 'info', container = 'test-results') {
            const results = document.getElementById(container);
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<span>${getIcon(type)}</span> ${message}`;
            results.appendChild(div);
        }
        
        function getIcon(type) {
            const icons = {
                'pass': '‚úÖ',
                'fail': '‚ùå',
                'warning': '‚ö†Ô∏è',
                'info': '‚ÑπÔ∏è'
            };
            return icons[type] || '‚ÑπÔ∏è';
        }
        
        function updateScore() {
            const totalTests = 4;
            const passedTests = Object.values(testResults).filter(score => score > 0).length;
            const percentage = Math.round((passedTests / totalTests) * 100);
            
            document.getElementById('security-score').textContent = `Security Score: ${percentage}%`;
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            
            let description = '';
            if (percentage >= 90) description = 'üü¢ Excellent! Your site is highly secure.';
            else if (percentage >= 70) description = 'üü° Good security, but some improvements needed.';
            else if (percentage >= 50) description = 'üü† Moderate security, several issues to address.';
            else description = 'üî¥ Poor security, immediate action required.';
            
            document.getElementById('score-description').textContent = description;
        }
        
        function checkSecurityHeaders() {
            const results = document.getElementById('headers-results');
            results.innerHTML = '';
            
            const requiredHeaders = [
                'Strict-Transport-Security',
                'Content-Security-Policy',
                'X-Frame-Options',
                'X-Content-Type-Options',
                'Referrer-Policy',
                'Permissions-Policy'
            ];
            
            let passed = 0;
            requiredHeaders.forEach(header => {
                const div = document.createElement('div');
                div.className = 'status warning';
                div.innerHTML = `<span>‚ö†Ô∏è</span> ${header}: Cannot check client-side (requires server response headers)`;
                results.appendChild(div);
            });
            
            addResult('üí° Use browser dev tools Network tab to check response headers', 'info', 'headers-results');
            testResults.headers = 1;
            updateScore();
        }
        
        function testCSP() {
            const results = document.getElementById('csp-results');
            results.innerHTML = '';
            
            // Test inline script blocking
            try {
                eval('console.log("CSP test")');
                addResult('‚ùå FAIL: Inline script executed (CSP should block this)', 'fail', 'csp-results');
            } catch (e) {
                addResult('‚úÖ PASS: Inline script blocked by CSP', 'pass', 'csp-results');
                testResults.csp = 1;
            }
            
            // Test external script loading
            const script = document.createElement('script');
            script.src = 'https://evil.example.com/malicious.js';
            script.onload = () => addResult('‚ùå FAIL: External script loaded (should be blocked)', 'fail', 'csp-results');
            script.onerror = () => addResult('‚úÖ PASS: External script blocked by CSP', 'pass', 'csp-results');
            document.head.appendChild(script);
            
            updateScore();
        }
        
        function testXSSProtection() {
            const results = document.getElementById('xss-results');
            results.innerHTML = '';
            
            // Test XSS protection
            const testScript = '<script>alert("XSS")</script>';
            const div = document.createElement('div');
            div.innerHTML = testScript;
            
            if (div.innerHTML.includes('alert')) {
                addResult('‚ùå FAIL: XSS protection not working', 'fail', 'xss-results');
            } else {
                addResult('‚úÖ PASS: XSS protection working', 'pass', 'xss-results');
                testResults.xss = 1;
            }
            
            updateScore();
        }
        
        function testClickjacking() {
            const results = document.getElementById('frame-results');
            results.innerHTML = '';
            
            // Test if page can be framed
            if (window.top === window.self) {
                addResult('‚úÖ PASS: Page cannot be framed (X-Frame-Options working)', 'pass', 'frame-results');
                testResults.frame = 1;
            } else {
                addResult('‚ùå FAIL: Page can be framed (X-Frame-Options not working)', 'fail', 'frame-results');
            }
            
            updateScore();
        }
        
        function runAllTests() {
            document.getElementById('test-results').innerHTML = '<h3>üìã Running All Security Tests...</h3>';
            
            setTimeout(() => {
                checkSecurityHeaders();
                testCSP();
                testXSSProtection();
                testClickjacking();
                
                addResult('üéâ All security tests completed!', 'info');
                addResult(`üìä Final Score: ${Math.round((Object.values(testResults).filter(score => score > 0).length / 4) * 100)}%`, 'info');
            }, 1000);
        }
        
        function generateReport() {
            const report = {
                timestamp: new Date().toISOString(),
                url: window.location.href,
                score: Math.round((Object.values(testResults).filter(score => score > 0).length / 4) * 100),
                tests: {
                    headers: testResults.headers,
                    csp: testResults.csp,
                    xss: testResults.xss,
                    frame: testResults.frame
                },
                recommendations: []
            };
            
            if (testResults.headers === 0) {
                report.recommendations.push('Implement server-side security headers');
            }
            if (testResults.csp === 0) {
                report.recommendations.push('Configure Content Security Policy');
            }
            if (testResults.xss === 0) {
                report.recommendations.push('Enable XSS protection');
            }
            if (testResults.frame === 0) {
                report.recommendations.push('Configure X-Frame-Options');
            }
            
            const reportText = JSON.stringify(report, null, 2);
            const blob = new Blob([reportText], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'security-report.json';
            a.click();
            URL.revokeObjectURL(url);
            
            addResult('üìä Security report generated and downloaded!', 'info');
        }
        
        // Initialize
        updateScore();
        addResult('üîí Security Headers Test loaded. Click buttons to test your security configuration.', 'info');
    </script>
</body>
</html>
